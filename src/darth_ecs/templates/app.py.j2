#!/usr/bin/env python3
"""CDK app entrypoint â€” generated by darth-ecs."""

import os
import aws_cdk as cdk

from stacks.main_stack import MainStack, load_project_config

config = load_project_config()

app = cdk.App()

env = cdk.Environment(
    account=os.getenv("CDK_DEFAULT_ACCOUNT"),
    region=config.aws_region,
)

stack = MainStack(app, f"{config.project_name}-ecs", config=config, env=env)

cdk.Tags.of(stack).add("project", config.project_name)
cdk.Tags.of(stack).add("managed-by", "darth-ecs")
cdk.Tags.of(stack).add("deployment-type", "ecs")
for key, value in config.tags.items():
    cdk.Tags.of(stack).add(key, value)

app.synth()
